#!/bin/zsh

: ${trash_dir=${${__SS_CFG_TRASH_DIRECTORY?missing the trash directory}:A}}

if [[ $1 = -- ]]; then
	shift
elif [[ $1 = -h || $1 == --help ]]; then
	echo "usage: $0 ... files"
	echo "  moves files to the ${(q)trash_dir}, possibly renaming them."
	echo "  trash dir is '__SS_CFG_TRASH_DIRECTORY' normally, but can be"
	echo "  overwritten by setting '\$trash_dir'."
	return -1
fi

if [[ ! -d $trash_dir ]]; then
	if [[ -e $trash_dir ]] then
		echo "$0: Trash directory ${(q)trash_dir} exists but is a file" >&2
		return 1
	fi

	mkdir -p $trash_dir || return $?
fi

mv-safe -- $@ $trash_dir
